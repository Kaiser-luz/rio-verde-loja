datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

// --- CATEGORIAS ---
model Category {
  id        String   @id
  name      String
  type      String
  createdAt DateTime @default(now())
}

// --- PRODUTOS ---
model Product {
  id               Int      @id @default(autoincrement())
  name             String
  category         String   
  price            Decimal  @db.Decimal(10, 2)
  priceUpholsterer Decimal? @db.Decimal(10, 2)
  stock            Decimal  @db.Decimal(10, 2)
  type             String   
  image            String   
  colors           Json     
  
  // Link para o PDF do Monstruário
  pdfUrl           String?  

  // Informações Técnicas para Frete
  width            Decimal? @db.Decimal(10, 2) // Largura em cm
  weight           Decimal? @db.Decimal(10, 3) // Peso em kg
  composition      String?

  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

// --- PERFIL DO USUÁRIO ---
model Profile {
  id        String   @id @default(uuid())
  userId    String   @unique
  name      String
  email     String   @unique
  cpf       String?
  phone     String?
  role      String   @default("customer")
  cnpj      String?  
  approved  Boolean  @default(false)

  // Endereço Padrão
  zipCode     String? 
  street      String? 
  number      String? 
  complement  String? 
  district    String? 
  city        String? 
  state       String? 
  
  createdAt DateTime @default(now())
}

// --- PEDIDOS ---
model Order {
  id          String      @id @default(uuid())
  customer    String?
  userId      String?     
  total       Decimal     @db.Decimal(10, 2)
  status      String      @default("pendente")
  
  // Logística
  deliveryMethod      String? 
  shippingCost        Decimal? @db.Decimal(10, 2)

  // Endereço de Entrega (Snapshot)
  shippingZipCode     String?
  shippingStreet      String?
  shippingNumber      String?
  shippingComplement  String?
  shippingDistrict    String?
  shippingCity        String?
  shippingState       String?
  
  items       OrderItem[]
  createdAt   DateTime    @default(now())
}

model OrderItem {
  id        String  @id @default(uuid())
  orderId   String
  order     Order   @relation(fields: [orderId], references: [id])
  productName String
  quantity    Decimal @db.Decimal(10, 2)
  price       Decimal @db.Decimal(10, 2)
  color       String
}